<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="AO Office 5.5.8  (Unix)">
	<META NAME="CREATED" CONTENT="20251210;18424400">
	<META NAME="CHANGED" CONTENT="20251210;18430700">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 2cm }
		P { margin-bottom: 0.21cm }
		P.western { so-language: en-GB }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-GB" DIR="LTR">
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;!doctype html&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;html lang=&quot;en&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;head&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;meta
charset=&quot;utf-8&quot; /&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;meta
name=&quot;viewport&quot;
content=&quot;width=device-width,initial-scale=1&quot; /&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;title&gt;Household
Budget — Tabbed (Forecast)&lt;/title&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;style&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
:root{--bg:#f6f9fc;--card:#fff;--accent:#0b67ff;--muted:#667085;--danger:#d32f2f;--success:#0a8a3b}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
body{font-family:system-ui,Segoe
UI,Roboto,Arial;margin:0;background:var(--bg);color:#0b1220}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  header{padding:14px
18px;border-bottom:1px solid #e6eefb}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.wrap{max-width:1100px;margin:18px auto;padding:0 12px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.topbar{display:flex;align-items:center;justify-content:space-between;gap:12px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.tabs{display:flex;gap:8px;margin:12px 0}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  .tab{padding:8px
12px;border-radius:8px;background:#fff;border:1px solid
transparent;cursor:pointer}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.tab.active{background:linear-gradient(180deg,#fff,#f3f8ff);border-color:rgba(11,102,255,0.12)}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.grid{display:grid;grid-template-columns:1fr;gap:12px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.card{background:var(--card);border-radius:10px;padding:12px;border:1px
solid rgba(11,102,255,0.04)}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.summary{display:flex;gap:8px;align-items:stretch}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  .summary
.item{flex:1;padding:10px;border-radius:8px;background:linear-gradient(180deg,#fff,#f8fbff);text-align:center}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
input,select,button{padding:8px;border-radius:8px;border:1px solid
#d7e3f9;font-size:14px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
button{background:var(--accent);color:#fff;border:0}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.small{font-size:12px;color:var(--muted)}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.tx-list{max-height:520px;overflow:auto;margin-top:8px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.tx-row{display:flex;gap:8px;padding:8px;border-bottom:1px solid
#f0f4fb;align-items:center}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.tx-left{flex:1;min-width:0}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.tag{display:inline-block;padding:4px
8px;border-radius:999px;background:#fbfcff;border:1px solid
rgba(0,0,0,0.06);font-size:13px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.right{min-width:140px;text-align:right}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.muted{color:var(--muted)}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.two-cols{display:grid;grid-template-columns:1fr 420px;gap:12px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
@media(max-width:900px){ .two-cols{grid-template-columns:1fr}
.tx-list{max-height:360px} }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.compact-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.footer-note{font-size:12px;color:#556; margin-top:8px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
.btn-ghost{background:transparent;border:1px solid
rgba(11,102,255,0.12);color:var(--accent)}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
table.forecast{width:100%;border-collapse:collapse;margin-top:8px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  table.forecast th,
table.forecast td{padding:6px;border-bottom:1px solid
#eef4fb;text-align:right;font-size:13px}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  table.forecast
th:first-child, table.forecast td:first-child{text-align:left}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;/style&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;/head&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;body&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;header&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  &lt;div class=&quot;wrap&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div
class=&quot;topbar&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;h1
style=&quot;margin:0&quot;&gt;Household Budget&lt;/h1&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;div
class=&quot;small muted&quot;&gt;Tabbed view — forecasts for 24
months&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;controls&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;exportCsv&quot; class=&quot;btn-ghost&quot;&gt;Export
CSV&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;input
id=&quot;importCsv&quot; type=&quot;file&quot; accept=&quot;.csv&quot;
style=&quot;display:none&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
for=&quot;importCsv&quot; class=&quot;tab btn-ghost&quot;
style=&quot;cursor:pointer;padding:8px 10px&quot;&gt;Import
CSV&lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;backupBtn&quot; class=&quot;btn-ghost&quot;&gt;Backup&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div
class=&quot;tabs&quot; id=&quot;tabs&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;tab active&quot;
data-tab=&quot;transactions&quot;&gt;Transactions&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;tab&quot; data-tab=&quot;add&quot;&gt;Add&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;tab&quot; data-tab=&quot;categories&quot;&gt;Categories&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;tab&quot; data-tab=&quot;forecast&quot;&gt;Forecast&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;tab&quot; data-tab=&quot;backup&quot;&gt;Backup&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;tab&quot; data-tab=&quot;settings&quot;&gt;Settings&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;/header&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;main class=&quot;wrap&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  &lt;div class=&quot;grid&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;!--
TRANSACTIONS TAB --&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div
id=&quot;transactions&quot; class=&quot;card tabpanel&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;summary&quot; style=&quot;margin-bottom:12px&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;div
class=&quot;item&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;div
class=&quot;small muted&quot;&gt;Income&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;div
id=&quot;sumIncome&quot; style=&quot;font-weight:700&quot;&gt;£0.00&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;div
class=&quot;item&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;div
class=&quot;small muted&quot;&gt;Expenses&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;div
id=&quot;sumExpense&quot; style=&quot;font-weight:700&quot;&gt;£0.00&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;div
class=&quot;item&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;div
class=&quot;small muted&quot;&gt;Net&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;div
id=&quot;sumNet&quot; style=&quot;font-weight:700&quot;&gt;£0.00&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
style=&quot;display:flex;gap:12px;align-items:center;margin-bottom:8px;flex-wrap:wrap&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;View:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;select
id=&quot;viewMode&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;month&quot;&gt;This month&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;4weeks&quot;&gt;Last 4 weeks&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;all&quot;&gt;All time&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;/select&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;Month filter:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;select
id=&quot;monthFilter&quot;&gt;&lt;/select&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;Category:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;select
id=&quot;categoryFilter&quot;&gt;&lt;option
value=&quot;&quot;&gt;All&lt;/option&gt;&lt;/select&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;clearFilters&quot; class=&quot;btn-ghost&quot;&gt;Clear&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;tx-list card&quot; id=&quot;txList&quot;
style=&quot;padding:0&quot;&gt;&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;!-- ADD TAB --&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div id=&quot;add&quot;
class=&quot;card tabpanel&quot; style=&quot;display:none&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;h3
style=&quot;margin-top:0&quot;&gt;Add transaction&lt;/h3&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;compact-row&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;input
id=&quot;txDate&quot; type=&quot;date&quot; style=&quot;width:150px&quot;
/&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;input
id=&quot;txAmount&quot; type=&quot;number&quot; placeholder=&quot;Amount&quot;
style=&quot;width:120px&quot; /&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;select
id=&quot;txType&quot; style=&quot;width:120px&quot;&gt;&lt;option
value=&quot;expense&quot;&gt;Expense&lt;/option&gt;&lt;option
value=&quot;income&quot;&gt;Income&lt;/option&gt;&lt;/select&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;input
id=&quot;txCategory&quot; list=&quot;catList&quot;
placeholder=&quot;Category&quot; style=&quot;min-width:160px&quot; /&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;datalist
id=&quot;catList&quot;&gt;&lt;/datalist&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;input
id=&quot;txDesc&quot; placeholder=&quot;Description&quot;
style=&quot;min-width:220px&quot; /&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;compact-row&quot; style=&quot;margin-top:8px&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;Recurrence:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;select
id=&quot;txRecurrence&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;none&quot;&gt;One-off / Irregular&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;monthly&quot;&gt;Monthly&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;4weeks&quot;&gt;Every 4 weeks&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;weekly&quot;&gt;Weekly&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">            &lt;option
value=&quot;yearly&quot;&gt;Yearly&lt;/option&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;/select&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;&lt;input id=&quot;includeProj&quot;
type=&quot;checkbox&quot; /&gt; Include in projections&lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;addTx&quot;&gt;Add&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;footer-note&quot;&gt;Tip: mark regular incomes/bills with
Monthly or Every 4 weeks and check &quot;Include in projections&quot;
if you want them in the 24-month forecast.&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;!-- CATEGORIES
TAB --&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div
id=&quot;categories&quot; class=&quot;card tabpanel&quot;
style=&quot;display:none&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;h3
style=&quot;margin-top:0&quot;&gt;Categories&lt;/h3&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
style=&quot;display:flex;gap:8px;align-items:center&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;input
id=&quot;newCat&quot; placeholder=&quot;New category&quot; /&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;addCat&quot;&gt;Add&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
id=&quot;catListArea&quot; style=&quot;margin-top:12px&quot;&gt;&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;!-- FORECAST
TAB --&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div
id=&quot;forecast&quot; class=&quot;card tabpanel&quot;
style=&quot;display:none&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;h3
style=&quot;margin:0 0 8px 0&quot;&gt;24-month Forecast&lt;/h3&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
style=&quot;display:flex;gap:8px;align-items:center;flex-wrap:wrap&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;Projection start date:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;input
id=&quot;projStart&quot; type=&quot;date&quot; /&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;Opening balance:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;input
id=&quot;openingBalance&quot; type=&quot;number&quot; step=&quot;0.01&quot;
/&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;genForecast&quot; class=&quot;btn-ghost&quot;&gt;Generate&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
id=&quot;forecastSummary&quot; style=&quot;margin-top:12px&quot;
class=&quot;small muted&quot;&gt;&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;table
class=&quot;forecast&quot; id=&quot;forecastTable&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">       
&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Month&lt;/th&gt;&lt;th&gt;Income&lt;/th&gt;&lt;th&gt;Expenses&lt;/th&gt;&lt;th&gt;Net&lt;/th&gt;&lt;th&gt;Balance&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;tbody
id=&quot;forecastBody&quot;&gt;&lt;/tbody&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/table&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;!-- BACKUP TAB
--&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div id=&quot;backup&quot;
class=&quot;card tabpanel&quot; style=&quot;display:none&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;h3
style=&quot;margin-top:0&quot;&gt;Backup &amp; Restore&lt;/h3&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
style=&quot;display:flex;gap:8px;align-items:center&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;exportJSON&quot; class=&quot;btn-ghost&quot;&gt;Backup
JSON&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;input
id=&quot;importJSON&quot; type=&quot;file&quot; accept=&quot;.json&quot;
style=&quot;display:none&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
for=&quot;importJSON&quot; class=&quot;btn-ghost&quot;
style=&quot;cursor:pointer&quot;&gt;Restore JSON&lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
style=&quot;margin-top:12px&quot; class=&quot;small muted&quot;&gt;CSV
export contains transactions only. JSON backup contains transactions
+ categories + settings.&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;!-- SETTINGS
TAB --&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;div
id=&quot;settings&quot; class=&quot;card tabpanel&quot;
style=&quot;display:none&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;h3
style=&quot;margin-top:0&quot;&gt;Settings&lt;/h3&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
class=&quot;small muted&quot;&gt;No encryption included in this
layout preview. If you want I can merge your existing encryption back
in (IndexedDB + AES-GCM).&lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;div
style=&quot;margin-top:12px&quot; class=&quot;compact-row&quot;&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;label
class=&quot;small&quot;&gt;Default projection include for new items:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          &lt;select
id=&quot;defaultInclude&quot;&gt;&lt;option
value=&quot;1&quot;&gt;Include&lt;/option&gt;&lt;option value=&quot;0&quot;&gt;Do
not include&lt;/option&gt;&lt;/select&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;/label&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        &lt;button
id=&quot;resetData&quot; class=&quot;btn-ghost&quot;&gt;Reset sample
data&lt;/button&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  &lt;/div&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;/main&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">&lt;script&gt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">/* Single-file logic:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> - IndexedDB storage
for tx and categories</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> - Tabs UI</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> - Add transactions
with recurrence + include in projections</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> - Forecast generator
for 24 months using start date + opening balance</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> - CSV export/import +
JSON backup/restore</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">*/</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// ---------- IndexedDB
tiny wrapper ----------</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const DB = 'budget_v2';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const STORE_TX = 'tx';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const STORE_CAT =
'cat';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const STORE_META =
'meta';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">let db = null;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function openDB(){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  return new
Promise((res, rej)=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const r =
indexedDB.open(DB, 1);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    r.onupgradeneeded =
(e)=&gt; {</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const idb =
e.target.result;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">     
if(!idb.objectStoreNames.contains(STORE_TX))
idb.createObjectStore(STORE_TX, {keyPath:'id'});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">     
if(!idb.objectStoreNames.contains(STORE_CAT))
idb.createObjectStore(STORE_CAT, {keyPath:'name'});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">     
if(!idb.objectStoreNames.contains(STORE_META))
idb.createObjectStore(STORE_META, {keyPath:'k'});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    };</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    r.onsuccess = e=&gt;{
db = e.target.result; res(db); };</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    r.onerror = e=&gt;
rej(e.target.error);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  });</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function txPut(obj){
return new Promise((res,rej)=&gt;{ const
t=db.transaction(STORE_TX,'readwrite').objectStore(STORE_TX).put(obj);
t.onsuccess=()=&gt;res(true); t.onerror=(e)=&gt;rej(e.target.error);
});}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function txGetAll(){
return new Promise((res,rej)=&gt;{ const
t=db.transaction(STORE_TX,'readonly').objectStore(STORE_TX).getAll();
t.onsuccess=()=&gt;res(t.result); t.onerror=(e)=&gt;rej(e.target.error);
});}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function txDelete(id){
return new Promise((res,rej)=&gt;{ const
t=db.transaction(STORE_TX,'readwrite').objectStore(STORE_TX).delete(id);
t.onsuccess=()=&gt;res(true); t.onerror=(e)=&gt;rej(e.target.error);
});}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function catPut(obj){
return new Promise((res,rej)=&gt;{ const
t=db.transaction(STORE_CAT,'readwrite').objectStore(STORE_CAT).put(obj);
t.onsuccess=()=&gt;res(true); t.onerror=(e)=&gt;rej(e.target.error);
});}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function catGetAll(){
return new Promise((res,rej)=&gt;{ const
t=db.transaction(STORE_CAT,'readonly').objectStore(STORE_CAT).getAll();
t.onsuccess=()=&gt;res(t.result); t.onerror=(e)=&gt;rej(e.target.error);
});}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function metaPut(k,v){
return new Promise((res,rej)=&gt;{ const
t=db.transaction(STORE_META,'readwrite').objectStore(STORE_META).put({k:k,val:v});
t.onsuccess=()=&gt;res(true); t.onerror=(e)=&gt;rej(e.target.error);
});}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function metaGet(k){
return new Promise((res,rej)=&gt;{ const
t=db.transaction(STORE_META,'readonly').objectStore(STORE_META).get(k);
t.onsuccess=()=&gt;res(t.result? t.result.val : null);
t.onerror=(e)=&gt;rej(e.target.error); });}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// ---------- UI
helpers ----------</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const tabs =
document.querySelectorAll('.tab');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">tabs.forEach(t=&gt;
t.addEventListener('click', ()=&gt; {</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
tabs.forEach(x=&gt;x.classList.remove('active'));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
t.classList.add('active');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
document.querySelectorAll('.tabpanel').forEach(p=&gt;p.style.display='none');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
document.getElementById(t.dataset.tab).style.display = 'block';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">}));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// controls</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const txDate =
document.getElementById('txDate');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const txAmount =
document.getElementById('txAmount');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const txType =
document.getElementById('txType');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const txCategory =
document.getElementById('txCategory');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const txDesc =
document.getElementById('txDesc');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const txRecurrence =
document.getElementById('txRecurrence');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const includeProj =
document.getElementById('includeProj');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const addTxBtn =
document.getElementById('addTx');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const txListEl =
document.getElementById('txList');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const catListArea =
document.getElementById('catListArea');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const catDatalist =
document.getElementById('catList');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const newCat =
document.getElementById('newCat');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const addCat =
document.getElementById('addCat');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const categoryFilter =
document.getElementById('categoryFilter');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const monthFilter =
document.getElementById('monthFilter');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const viewMode =
document.getElementById('viewMode');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const clearFilters =
document.getElementById('clearFilters');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const sumIncome =
document.getElementById('sumIncome');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const sumExpense =
document.getElementById('sumExpense');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const sumNet =
document.getElementById('sumNet');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const projStart =
document.getElementById('projStart');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const openingBalance =
document.getElementById('openingBalance');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const genForecast =
document.getElementById('genForecast');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const forecastBody =
document.getElementById('forecastBody');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const forecastSummary =
document.getElementById('forecastSummary');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const exportCsv =
document.getElementById('exportCsv');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const importCsv =
document.getElementById('importCsv');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const exportJSON =
document.getElementById('exportJSON');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const importJSON =
document.getElementById('importJSON');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">const backupBtn =
document.getElementById('backupBtn');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// defaults</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">txDate.value = new
Date().toISOString().slice(0,10);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// ---------- Boot
----------</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">(async function boot(){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await openDB();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // ensure some
categories exist if none</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const cats = await
catGetAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  if(!cats ||
cats.length===0){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const defaults =
[&quot;Uncategorized&quot;,&quot;Salary (Monthly)&quot;,&quot;Salary
(4-weekly)&quot;,&quot;Rent/Mortgage&quot;,&quot;Gas&quot;,&quot;Electricity&quot;,&quot;Water&quot;,&quot;Council
Tax&quot;,&quot;Broadband&quot;,&quot;Mobile&quot;,&quot;Food/Shopping&quot;,&quot;Transport&quot;,&quot;Insurance&quot;,&quot;Subscriptions&quot;,&quot;Entertainment&quot;,&quot;Miscellaneous&quot;];</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    for(const c of
defaults) await catPut({name:c});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await renderAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">})();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// ---------- CRUD &amp;
rendering ----------</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function uid(){ return
't'+Date.now()+Math.floor(Math.random()*9999); }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">addTxBtn.addEventListener('click',
async ()=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const d =
txDate.value;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const a =
Number(txAmount.value) || 0;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const t =
txType.value;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const c =
(txCategory.value || '').trim() || 'Uncategorized';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const desc =
txDesc.value.trim();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const rec =
txRecurrence.value || 'none';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const incl =
includeProj.checked;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  if(!d){ alert('Pick a
date'); return; }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const obj = { id:
uid(), date: d, amount: a.toFixed(2), type:t, category:c,
description:desc, recurrence:rec, includeInProjection: !!incl };</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await txPut(obj);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await
catPut({name:c});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  txAmount.value = '';
txDesc.value=''; txCategory.value='';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await renderAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">addCat.addEventListener('click',
async ()=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const name =
(newCat.value||'').trim(); if(!name) return;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await catPut({name});
newCat.value=''; renderCategories();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">async function
renderAll(){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const all = await
txGetAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  renderTxList(all);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  renderSummary(all);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await
renderCategories();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
renderMonthFilter(all);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">async function
renderCategories(){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const cats = await
catGetAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  catListArea.innerHTML
= cats.map(c=&gt;`&lt;div
style=&quot;display:flex;justify-content:space-between;padding:6px
0&quot;&gt;&lt;div&gt;${escapeHtml(c.name)}&lt;/div&gt;&lt;div&gt;&lt;button
class=&quot;btn-ghost&quot; data-name=&quot;${escapeHtml(c.name)}&quot;
onclick=&quot;renameCat('${escapeHtml(c.name)}')&quot;&gt;Edit&lt;/button&gt;&lt;button
class=&quot;btn-ghost&quot;
onclick=&quot;deleteCat('${escapeHtml(c.name)}')&quot;&gt;Delete&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;`).join('');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  catDatalist.innerHTML
= cats.map(c=&gt;`&lt;option
value=&quot;${escapeHtml(c.name)}&quot;&gt;`).join('');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
categoryFilter.innerHTML = '&lt;option value=&quot;&quot;&gt;All&lt;/option&gt;'
+ cats.map(c=&gt;`&lt;option
value=&quot;${escapeHtml(c.name)}&quot;&gt;${escapeHtml(c.name)}&lt;/option&gt;`).join('');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">window.renameCat =
async function(oldName){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const nv =
prompt('Rename category', oldName); if(!nv) return;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // update store:
delete old, add new; update transactions</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await
catPut({name:nv});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // update txs</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const all = await
txGetAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  for(const tx of all){
if(tx.category===oldName){ tx.category=nv; await txPut(tx);} }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // remove old cat</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const tx =
db.transaction(STORE_CAT,'readwrite').objectStore(STORE_CAT').delete(oldName);
// attempt delete; ignore error</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await renderAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">};</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">window.deleteCat =
async function(name){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  if(!confirm('Delete
category? Transactions will be moved to Uncategorized')) return;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // update txs</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const all = await
txGetAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  for(const tx of all){
if(tx.category===name){ tx.category='Uncategorized'; await
txPut(tx);} }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // delete cat record</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
db.transaction(STORE_CAT,'readwrite').objectStore(STORE_CAT).delete(name);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  await renderAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">};</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function escapeHtml(s){
if(!s) return ''; return String(s).replace(/[&amp;&lt;&gt;&quot;']/g,
c=&gt;({'&amp;':'&amp;amp;','&lt;':'&amp;lt;','&gt;':'&amp;gt;','&quot;':'&amp;quot;',&quot;'&quot;:'&amp;#39;'}[c]||c));
}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">async function
renderTxList(all){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // sort newest first</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  all.sort((a,b)=&gt;
new Date(b.date) - new Date(a.date));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const fm =
monthFilter.value || '';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const catf =
categoryFilter.value || '';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const mode =
viewMode.value;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // filter for display
only</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const visible =
all.filter(tx =&gt; (!fm || tx.date.startsWith(fm)) &amp;&amp; (!catf
|| tx.category===catf));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
if(visible.length===0) { txListEl.innerHTML = '&lt;div class=&quot;small
muted&quot;&gt;No transactions&lt;/div&gt;'; return; }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  txListEl.innerHTML =
visible.map(tx =&gt; {</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const amt =
tx.type==='income' ? parseFloat(tx.amount) : parseFloat(tx.amount);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const sign =
tx.type==='income' ? '+' : '-';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    return `&lt;div
class=&quot;tx-row&quot;&gt;&lt;div class=&quot;tx-left&quot;&gt;&lt;div
style=&quot;font-weight:600&quot;&gt;${tx.date} &lt;span
class=&quot;tag&quot;&gt;${escapeHtml(tx.category)}&lt;/span&gt;&lt;/div&gt;&lt;div
class=&quot;small
muted&quot;&gt;${escapeHtml(tx.description||'')}&lt;/div&gt;&lt;/div&gt;&lt;div
class=&quot;right&quot;&gt;&lt;div
style=&quot;font-weight:700;color:${tx.type==='income'?'var(--success)':'var(--danger)'}&quot;&gt;${sign}£${Math.abs(amt).toFixed(2)}&lt;/div&gt;&lt;div
class=&quot;small muted&quot;&gt;${tx.recurrence}${tx.includeInProjection?
' • included':''}&lt;/div&gt;&lt;div style=&quot;margin-top:6px&quot;&gt;&lt;button
class=&quot;btn-ghost&quot;
onclick=&quot;deleteTx('${tx.id}')&quot;&gt;Delete&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;`;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  }).join('');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">async function
deleteTx(id){ if(!confirm('Delete?')) return; await txDelete(id);
await renderAll(); }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">async function
renderSummary(all){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const mode =
viewMode.value;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  let start=null,
end=null;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const now = new
Date();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  if(mode==='month'){
start = new Date(now.getFullYear(), now.getMonth(), 1); end = new
Date(now.getFullYear(), now.getMonth()+1, 0, 23,59,59,999); }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  else
if(mode==='4weeks'){ end = new Date(); start = new Date();
start.setDate(end.getDate()-27); start.setHours(0,0,0,0); }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  let income=0,
expense=0;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  for(const tx of all){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const txd = new
Date(tx.date + 'T00:00:00');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const inRange =
!start || (txd&gt;=start &amp;&amp; txd&lt;=end);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    if(inRange){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">     
if(tx.type==='income') income += Number(tx.amount);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      else expense +=
Number(tx.amount);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  sumIncome.textContent
= '£' + income.toFixed(2);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
sumExpense.textContent = '£' + expense.toFixed(2);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  sumNet.textContent =
(income - expense &gt;= 0 ? '£' : '-£') + Math.abs(income -
expense).toFixed(2);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// ---------- month
filter ----------</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function
renderMonthFilter(all){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const months =
Array.from(new Set(all.map(t=&gt; t.date?
t.date.slice(0,7):null))).filter(Boolean).sort().reverse();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  monthFilter.innerHTML
= '&lt;option value=&quot;&quot;&gt;(all)&lt;/option&gt;' +
months.map(m=&gt;`&lt;option value=&quot;${m}&quot;&gt;${m}&lt;/option&gt;`).join('');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">}</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">clearFilters.addEventListener('click',
()=&gt;{ monthFilter.value=''; categoryFilter.value='';
viewMode.value='month'; renderAll(); });</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// ---------- Forecast
generation ----------</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function
addMonths(date, n){ const d=new Date(date.getFullYear(),
date.getMonth()+n, 1); return d; }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function
formatMonthKey(d){ const y=d.getFullYear(); const
m=(d.getMonth()+1).toString().padStart(2,'0'); return y + '-' + m; }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">function
lastDayOfMonth(y,m){ return new Date(y,m+1,0).getDate(); }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">genForecast.addEventListener('click',
async ()=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const startVal =
projStart.value;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  if(!startVal){
alert('Pick a projection start date'); return; }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const startDate = new
Date(startVal + 'T00:00:00');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const opening =
Number(openingBalance.value) || 0;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // gather txs that
are flagged includeInProjection OR have recurrence != none</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const all = await
txGetAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const projSources =
all.filter(tx =&gt; tx.includeInProjection || (tx.recurrence &amp;&amp;
tx.recurrence!=='none'));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // build months array</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const months=[];</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  for(let
i=0;i&lt;24;i++){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const d =
addMonths(startDate, i);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    months.push({ key:
formatMonthKey(d), date: new Date(d.getFullYear(), d.getMonth(), 1),
income:0, expense:0 });</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // helper to add
occurrence</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  function
addOccurrence(monthKey, amt, isIncome){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const m =
months.find(x=&gt;x.key===monthKey); if(!m) return;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    if(isIncome)
m.income += amt; else m.expense += amt;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // iterate sources</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
projSources.forEach(tx=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const base = new
Date(tx.date + 'T00:00:00');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const amt =
Number(tx.amount);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const isIncome =
tx.type === 'income';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    if(tx.recurrence
=== 'none' || !tx.recurrence){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      // one-off:
include if within range and includeInProjection true</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">     
if(tx.includeInProjection){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        const key =
tx.date.slice(0,7);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">       
addOccurrence(key, amt, isIncome);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    } else
if(tx.recurrence === 'monthly'){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      // add to each
month on same day (cap at last day)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">     
months.forEach(m=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        const [y,mm] =
m.key.split('-'); const day = Math.min(base.getDate(),
lastDayOfMonth(Number(y), Number(mm)-1));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        const occStr =
`${m.key}-${String(day).padStart(2,'0')}`;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        // if
occurrence date &gt;= base date? we will project occurrences
regardless - assume recurring applies from base or earlier</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">       
addOccurrence(m.key, amt, isIncome);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      });</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    } else
if(tx.recurrence === '4weeks'){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      // treat as every
28 days from base; find occurrences that fall into any month</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const ms28 = 28 *
24 * 3600 * 1000;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      // search
occurrences in window [startDate, endDateLastMonth]</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const start =
months[0].date;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const end = new
Date(months[months.length-1].date.getFullYear(),
months[months.length-1].date.getMonth()+1, 0,23,59,59,999);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      // compute k
offset so base + k*28d &gt;= start - a few cycles back</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      let k =
Math.floor((start - base) / ms28) - 2;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      for(; ; k++){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        const occ = new
Date(base.getTime() + k * ms28);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        if(occ &gt;
end) break;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        if(occ &gt;=
start &amp;&amp; occ &lt;= end){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          const key =
occ.toISOString().slice(0,7);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">         
addOccurrence(key, amt, isIncome);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    } else
if(tx.recurrence === 'weekly'){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      // every 7 days -
similar to 4weeks</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const ms7 =
7*24*3600*1000;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const start =
months[0].date;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const end = new
Date(months[months.length-1].date.getFullYear(),
months[months.length-1].date.getMonth()+1, 0,23,59,59,999);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      let k =
Math.floor((start - base) / ms7) - 4;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      for(; ; k++){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        const occ = new
Date(base.getTime() + k * ms7);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        if(occ &gt;
end) break;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        if(occ &gt;=
start &amp;&amp; occ &lt;= end){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">          const key =
occ.toISOString().slice(0,7);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">         
addOccurrence(key, Number(tx.amount), isIncome);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    } else
if(tx.recurrence === 'yearly'){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">     
months.forEach(m=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        const y =
Number(m.key.slice(0,4));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        const occ = new
Date(y, base.getMonth(), base.getDate());</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        if(occ &gt;=
months[0].date &amp;&amp; occ &lt;= new
Date(months[months.length-1].date.getFullYear(),
months[months.length-1].date.getMonth()+1,0,23,59,59,999)){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">         
addOccurrence(m.key, amt, isIncome);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">        }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      });</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    }</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  });</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  // now compute
running balance starting from opening</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  let running =
opening;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
forecastBody.innerHTML = '';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  months.forEach(m=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const net =
m.income - m.expense;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    running += net;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const row =
`&lt;tr&gt;&lt;td&gt;${m.date.toLocaleString(undefined,{month:'short',year:'numeric'})}&lt;/td&gt;&lt;td&gt;£${m.income.toFixed(2)}&lt;/td&gt;&lt;td&gt;£${m.expense.toFixed(2)}&lt;/td&gt;&lt;td&gt;£${net.toFixed(2)}&lt;/td&gt;&lt;td&gt;£${running.toFixed(2)}&lt;/td&gt;&lt;/tr&gt;`;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">   
forecastBody.insertAdjacentHTML('beforeend', row);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  });</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
forecastSummary.textContent = `Projection start ${startVal}, opening
balance £${opening.toFixed(2)}. Projected end balance:
£${running.toFixed(2)}.`;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">// ---------- CSV
export/import &amp; JSON backup ----------</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">exportCsv.addEventListener('click',
async ()=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const all = await
txGetAll();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const lines =
['id,date,type,category,description,amount,recurrence,includeInProjection'];</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  all.forEach(d =&gt;
lines.push([d.id,d.date,d.type,`&quot;${(d.category||'').replace(/&quot;/g,'&quot;&quot;')}`.replace(/&quot;$/,''),`&quot;${(d.description||'').replace(/&quot;/g,'&quot;&quot;')}`.replace(/&quot;$/,''),d.amount,d.recurrence||'none',d.includeInProjection?1:0].join(',')));</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const blob = new
Blob([lines.join('\\n')], {type:'text/csv'});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const url =
URL.createObjectURL(blob); const a = document.createElement('a');
a.href=url; a.download='transactions.csv'; a.click();
URL.revokeObjectURL(url);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">});</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">importCsv.addEventListener('change',
async (ev)=&gt;{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const f =
ev.target.files[0]; if(!f) return;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  const txt = await
f.text();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">  try{</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const lines =
txt.trim().split(/\\r?\\n/).filter(Boolean);</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    const hdr =
lines.shift();</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">    for(const line of
lines){</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      // naive parse -
split by comma, handle quoted category/desc crudely</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const parts =
line.split(',');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const id =
parts[0];</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const date =
parts[1];</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const type =
parts[2];</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const category =
parts[3].replace(/^&quot;|&quot;$/g,'');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const description
= parts[4].replace(/^&quot;|&quot;$/g,'');</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const amount =
parts[5];</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const recurrence
= parts[6] || 'none';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const
includeInProjection = parts[7] &amp;&amp; parts[7].trim() === '1';</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">      const</P>
</BODY>
</HTML>